<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO TDK - éœ€è¦æ›¿æ¢ -->
    <title>æ‰«ææœåŠ¡æ¶æ„æ¢³ç†ï¼šPCç«¯ä¸ç§»åŠ¨ç«¯æ‰«ææœåŠ¡å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ | èŠ¯å›¾æ—¥è®°</title>
    <meta name="description" content="å…¨é¢æ¢³ç†èŠ¯å›¾ç›¸å†Œæ‰«ææœåŠ¡çš„æ¶æ„è®¾è®¡ï¼Œè¯¦ç»†å¯¹æ¯”PCç«¯å’Œç§»åŠ¨ç«¯çš„å®ç°å·®å¼‚ã€‚æ¶µç›–æ‰«æçŠ¶æ€ç®¡ç†ã€è¿›åº¦æ¶ˆæ¯æ›´æ–°æœºåˆ¶ã€æ•°æ®è¯»å†™æµç¨‹ã€ç•Œé¢åˆ·æ–°ç­–ç•¥ç­‰æ ¸å¿ƒæŠ€æœ¯ç»†èŠ‚ï¼Œæ·±å…¥è§£æPCç«¯çº¯JSå®ç°å’Œç§»åŠ¨ç«¯ä¸‰å±‚æ¶æ„ï¼ˆå‰å°æœåŠ¡+åŸç”Ÿå±‚+JSå±‚ï¼‰çš„è®¾è®¡æ€è·¯ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£æ‰«ææœåŠ¡çš„å®Œæ•´æŠ€æœ¯å®ç°ã€‚">
    <meta name="keywords" content="æŠ€æœ¯æ¶æ„, æ‰«ææœåŠ¡, PCç«¯, ç§»åŠ¨ç«¯, ç³»ç»Ÿè®¾è®¡, ç ”å‘ç»éªŒ">
    
    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="æ‰«ææœåŠ¡æ¶æ„æ¢³ç†ï¼šPCç«¯ä¸ç§»åŠ¨ç«¯æ‰«ææœåŠ¡å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ">
    <meta property="og:description" content="å…¨é¢æ¢³ç†èŠ¯å›¾ç›¸å†Œæ‰«ææœåŠ¡çš„æ¶æ„è®¾è®¡ï¼Œè¯¦ç»†å¯¹æ¯”PCç«¯å’Œç§»åŠ¨ç«¯çš„å®ç°å·®å¼‚ã€‚æ¶µç›–æ‰«æçŠ¶æ€ç®¡ç†ã€è¿›åº¦æ¶ˆæ¯æ›´æ–°æœºåˆ¶ã€æ•°æ®è¯»å†™æµç¨‹ã€ç•Œé¢åˆ·æ–°ç­–ç•¥ç­‰æ ¸å¿ƒæŠ€æœ¯ç»†èŠ‚ï¼Œæ·±å…¥è§£æPCç«¯çº¯JSå®ç°å’Œç§»åŠ¨ç«¯ä¸‰å±‚æ¶æ„ï¼ˆå‰å°æœåŠ¡+åŸç”Ÿå±‚+JSå±‚ï¼‰çš„è®¾è®¡æ€è·¯ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£æ‰«ææœåŠ¡çš„å®Œæ•´æŠ€æœ¯å®ç°ã€‚">
    <meta property="og:image" content="/assets/diary/backend-arch/cover.png">
    <meta property="og:url" content="https://www.xintuxiangce.top/diary/architecture-for-scanning.html">
    
    <!-- ç»“æ„åŒ–æ•°æ® - Article -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "æ‰«ææœåŠ¡æ¶æ„æ¢³ç†ï¼šPCç«¯ä¸ç§»åŠ¨ç«¯æ‰«ææœåŠ¡å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ",
        "description": "å…¨é¢æ¢³ç†èŠ¯å›¾ç›¸å†Œæ‰«ææœåŠ¡çš„æ¶æ„è®¾è®¡ï¼Œè¯¦ç»†å¯¹æ¯”PCç«¯å’Œç§»åŠ¨ç«¯çš„å®ç°å·®å¼‚ã€‚æ¶µç›–æ‰«æçŠ¶æ€ç®¡ç†ã€è¿›åº¦æ¶ˆæ¯æ›´æ–°æœºåˆ¶ã€æ•°æ®è¯»å†™æµç¨‹ã€ç•Œé¢åˆ·æ–°ç­–ç•¥ç­‰æ ¸å¿ƒæŠ€æœ¯ç»†èŠ‚ï¼Œæ·±å…¥è§£æPCç«¯çº¯JSå®ç°å’Œç§»åŠ¨ç«¯ä¸‰å±‚æ¶æ„ï¼ˆå‰å°æœåŠ¡+åŸç”Ÿå±‚+JSå±‚ï¼‰çš„è®¾è®¡æ€è·¯ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£æ‰«ææœåŠ¡çš„å®Œæ•´æŠ€æœ¯å®ç°ã€‚",
        "image": "/assets/diary/backend-arch/cover.png",
        "author": {
            "@type": "Organization",
            "name": "èŠ¯å›¾å›¢é˜Ÿ"
        },
        "publisher": {
            "@type": "Organization",
            "name": "èŠ¯å›¾ç›¸å†Œ"
        },
        "datePublished": "2026å¹´01æœˆ06æ—¥",
        "dateModified": "2026å¹´01æœˆ06æ—¥"
    }
    </script>
    
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "é¦–é¡µ",
                "item": "https://www.xintuxiangce.top"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "èŠ¯å›¾æ—¥è®°",
                "item": "https://www.xintuxiangce.top/diary.html"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "æ‰«ææœåŠ¡æ¶æ„æ¢³ç†ï¼šPCç«¯ä¸ç§»åŠ¨ç«¯æ‰«ææœåŠ¡å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ",
                "item": "https://www.xintuxiangce.top/diary/architecture-for-scanning.html"
            }
        ]
    }
    </script>
    
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" type="image/png" href="/icons/imageclassify.png">
    
    <!-- ç»„ä»¶åŠ è½½å™¨ - å¿…é¡»åœ¨bodyä¹‹å‰åŠ è½½ -->
    <script src="../components-loader.js"></script>
    
    <style>
        .article-header {
            max-width: 800px;
            margin: 0 auto 60px;
            text-align: center;
            padding: 40px 20px 0;
        }
        
        .article-header h1 {
            font-size: 36px;
            line-height: 1.3;
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        
        .article-meta {
            display: flex;
            justify-content: center;
            gap: 24px;
            flex-wrap: wrap;
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 40px;
        }
        
        .article-cover {
            width: 100%;
            max-width: 800px;
            margin: 0 auto 40px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }
        
        .article-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px 30px;
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-primary);
        }
        
        .article-content h2 {
            font-size: 28px;
            margin: 40px 0 20px;
            color: var(--text-primary);
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 10px;
        }
        
        .article-content h3 {
            font-size: 22px;
            margin: 30px 0 15px;
            color: var(--text-primary);
        }
        
        .article-content p {
            margin-bottom: 20px;
        }
        
        .article-content ul,
        .article-content ol {
            margin: 20px 0;
            padding-left: 30px;
        }
        
        .article-content li {
            margin-bottom: 10px;
        }
        
        .article-content code {
            background: var(--bg-light);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .article-content pre {
            background: var(--bg-light);
            padding: 20px;
            border-radius: var(--radius-md);
            overflow-x: auto;
            margin: 20px 0;
        }
        
        .article-content pre code {
            background: none;
            padding: 0;
        }
        
        .article-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 20px 0;
        }
        
        .article-tag {
            padding: 6px 14px;
            background: var(--primary-light);
            color: var(--primary-color);
            border-radius: 16px;
            font-size: 14px;
        }
        
        .article-footer {
            max-width: 800px;
            margin: 60px auto;
            padding: 40px 20px;
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            text-align: center;
        }
        
        .back-btn {
            display: inline-block;
            padding: 12px 32px;
            background: var(--primary-color);
            color: white;
            border-radius: var(--radius-md);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .back-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .related-articles {
            max-width: 800px;
            margin: 30px auto 40px;
            padding: 40px 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-top: 3px solid #667eea;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .related-articles h2 {
            font-size: 24px;
            margin-bottom: 30px;
            color: #333;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            font-weight: 600;
        }
        
        .related-articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .related-article-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .related-article-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            border-color: #667eea;
        }
        
        .related-article-card h3 {
            font-size: 18px;
            margin: 0 0 10px 0;
            color: #667eea;
            font-weight: 600;
        }
        
        .related-article-card p {
            font-size: 14px;
            color: #666;
            margin: 0;
            line-height: 1.6;
        }
        
        @media (max-width: 768px) {
            .article-header h1 {
                font-size: 28px;
            }
            
            .article-content {
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ å’Œåº•éƒ¨æ å°†é€šè¿‡ components-loader.js è‡ªåŠ¨åŠ è½½ -->
    
    <main>
        <article>
            <header class="article-header">
                <h1>æ‰«ææœåŠ¡æ¶æ„æ¢³ç†ï¼šPCç«¯ä¸ç§»åŠ¨ç«¯æ‰«ææœåŠ¡å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ</h1>
                <div class="article-meta">
                    <span>ğŸ“… 2026å¹´01æœˆ06æ—¥</span>
                    <span>âœï¸ èŠ¯å›¾å›¢é˜Ÿ</span>
                    <span>â±ï¸ 25åˆ†é’Ÿ</span>
                </div>
                <img src="/assets/diary/backend-arch/cover.png" alt="æ‰«ææœåŠ¡æ¶æ„æ¢³ç†ï¼šPCç«¯ä¸ç§»åŠ¨ç«¯æ‰«ææœåŠ¡å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ" class="article-cover">
            </header>
            
            <div class="article-content">
                <h2>ç›®å½•</h2>
<p>1. <a href="#pcç«¯æ‰«ææœåŠ¡æ¶æ„">PCç«¯æ‰«ææœåŠ¡æ¶æ„</a></p>
<p>2. <a href="#ç§»åŠ¨ç«¯æ‰«ææœåŠ¡æ¶æ„">ç§»åŠ¨ç«¯æ‰«ææœåŠ¡æ¶æ„</a></p>
<p>3. <a href="#å…³é”®æœºåˆ¶å¯¹æ¯”">å…³é”®æœºåˆ¶å¯¹æ¯”</a></p>
<p>---</p>
<h2>PCç«¯æ‰«ææœåŠ¡æ¶æ„</h2>
<h3>1. æ‰«æçŠ¶æ€ç®¡ç†</h3>
<p>#### 1.1 çŠ¶æ€å˜é‡</p>
<ul>
<li><strong>ç•Œé¢å±‚çŠ¶æ€</strong> (<code>HomeScreen.desktop.js</code>):</li>
<li><code>isScanning</code>: React stateï¼Œæ§åˆ¶æ‰«æUIçŠ¶æ€</li>
<li><code>globalMessage</code>: React stateï¼Œæ˜¾ç¤ºæ‰«æè¿›åº¦æ¶ˆæ¯</li>
<li><code>window.isScanning</code>: å…¨å±€å˜é‡ï¼Œä¾›å…¶ä»–é¡µé¢æ£€æŸ¥æ‰«æçŠ¶æ€</li>
</ul>
<ul>
<li><strong>æœåŠ¡å±‚çŠ¶æ€</strong> (<code>GalleryScannerService.js</code>):</li>
<li><code>this.isScanning</code>: æœåŠ¡å†…éƒ¨æ‰«æçŠ¶æ€æ ‡å¿—</li>
<li><code>this.isInitialized</code>: æœåŠ¡åˆå§‹åŒ–æ ‡å¿—</li>
<li><code>this.onProgress</code>: è¿›åº¦å›è°ƒå‡½æ•°å¼•ç”¨</li>
</ul>
<p>#### 1.2 çŠ¶æ€æµè½¬</p>
<pre><code></code></pre>
<h3>2. è¿›åº¦æ¶ˆæ¯æ›´æ–°æœºåˆ¶</h3>
<p>#### 2.1 è¿›åº¦æ¶ˆæ¯ç”Ÿæˆæµç¨‹</p>
<pre><code></code></pre>
<p>#### 2.2 è¿›åº¦æ¶ˆæ¯å»é‡</p>
<ul>
<li>PCç«¯ä½¿ç”¨ <code>lastProgressMessage</code> é”®å€¼å»é‡</li>
<li>æ ¼å¼ï¼š<code>${stage}_${totalFoundThisPhase}_${processedThisPhase}</code></li>
<li>ç›¸ä¼¼åº¦æ£€æµ‹é˜¶æ®µä¸è¿‡æ»¤ï¼ˆå…è®¸é¢‘ç¹æ›´æ–°ï¼‰</li>
</ul>
<p>#### 2.3 è¿›åº¦é˜¶æ®µå®šä¹‰</p>
<ul>
<li><code>initializing</code>: åˆå§‹åŒ–æ‰«æ</li>
<li><code>directory_scanning</code>: ç›®å½•æ‰«æ</li>
<li><code>file_comparison</code>: æ–‡ä»¶æ¯”å¯¹</li>
<li><code>screenshot_detection</code>: æˆªå›¾æ£€æµ‹</li>
<li><code>cache_checking</code>: ç¼“å­˜æ£€æŸ¥</li>
<li><code>remote_inference</code>: è¿œç¨‹æ¨ç†</li>
<li><code>local_inference</code>: æœ¬åœ°æ¨ç†</li>
<li><code>similarity_detection</code>: ç›¸ä¼¼åº¦æ£€æµ‹</li>
<li><code>location_enrichment</code>: ä½ç½®ä¿¡æ¯è¡¥å…¨</li>
<li><code>completed</code>: æ‰«æå®Œæˆ</li>
</ul>
<h3>3. æ•°æ®è¯»å†™æœºåˆ¶</h3>
<p>#### 3.1 æ•°æ®å†™å…¥æµç¨‹ï¼ˆæŒ‰ä¸šåŠ¡æµç¨‹åˆ’åˆ†ï¼‰</p>
<p>##### 3.1.1 åŸºç¡€æ‰«æï¼ˆJSå±‚ï¼šä»æ–‡ä»¶ç³»ç»Ÿæ”¶é›†æ•°æ®å†™å…¥æœ¬åœ°æ•°æ®åº“ï¼‰</p>
<pre><code></code></pre>
<p>##### 3.1.2 æœ¬åœ°MobileNetV3æ¨ç†ï¼ˆJSå±‚ï¼šå¯é€‰ï¼Œè¾…åŠ©åŠŸèƒ½ï¼‰</p>
<pre><code></code></pre>
<p>##### 3.1.3 AIåˆ†ç±»ï¼ˆJSå±‚ï¼šä»åç«¯APIè·å–æ•°æ®å†™å…¥æœ¬åœ°æ•°æ®åº“ï¼‰</p>
<pre><code></code></pre>
<p>##### 3.1.4 ç›¸ä¼¼åº¦æ£€æµ‹ï¼ˆJSå±‚ï¼šå¯é€‰ï¼Œå¯å•ç‹¬è§¦å‘ï¼‰</p>
<pre><code></code></pre>
<p>##### 3.1.5 åŸå¸‚ä¿¡æ¯è¡¥å…¨ï¼ˆJSå±‚ï¼šå¯é€‰ï¼Œå¯å•ç‹¬è§¦å‘ï¼‰</p>
<pre><code></code></pre>
<p>#### 3.2 æ•°æ®ç¼“å­˜ä¸ç•Œé¢æ•°æ®äº¤æ¢æœºåˆ¶</p>
<p>##### 3.2.1 ç¼“å­˜ä¼˜å…ˆè¯»å–æœºåˆ¶</p>
<pre><code></code></pre>
<p>##### 3.2.2 æ•°æ®åˆ†çº§ç­–ç•¥ï¼ˆç²¾ç®€ä¿¡æ¯ vs è¯¦ç»†ä¿¡æ¯ï¼‰</p>
<pre><code></code></pre>
<p>##### 3.2.3 æŒ‰éœ€åŠ è½½è¯¦ç»†ä¿¡æ¯</p>
<pre><code></code></pre>
<p>##### 3.2.5 å¤šç»´åº¦åˆ†ç±»æ”¯æŒæœºåˆ¶</p>
<pre><code></code></pre>
<p>##### 3.2.4 ç»Ÿä¸€æ•°æ®æœåŠ¡æ¥å£</p>
<pre><code></code></pre>
<p>#### 3.3 æ•°æ®åˆ·æ–°ç­–ç•¥</p>
<ul>
<li><strong>æ‰«æå®Œæˆæ—¶</strong>: <code>progress.shouldRefresh === true</code> æ—¶åˆ·æ–°</li>
<li><strong>ä½ç½®ä¿¡æ¯è¡¥å…¨</strong>: æ¯å¤„ç†50å¼ å›¾ç‰‡è§¦å‘ä¸€æ¬¡åˆ·æ–°</li>
<li><strong>ç›¸ä¼¼åº¦æ£€æµ‹</strong>: æ¯æ£€æµ‹å®Œä¸€ä¸ªç›¸ä¼¼ç»„è§¦å‘åˆ·æ–°</li>
<li><strong>é˜²æŠ–æœºåˆ¶</strong>: PCç«¯æ— é˜²æŠ–ï¼Œç›´æ¥åˆ·æ–°</li>
</ul>
<h3>4. ç•Œé¢æ•°æ®åˆ·æ–°</h3>
<p>#### 4.1 åˆ·æ–°è§¦å‘ç‚¹</p>
<pre><code></code></pre>
<p>#### 4.2 åˆ·æ–°å†…å®¹</p>
<ul>
<li>åˆ†ç±»ç»Ÿè®¡ (<code>loadCategories()</code>)</li>
<li>åŸå¸‚ç»Ÿè®¡ (<code>loadCities()</code>)</li>
<li>ç›¸ä¼¼ç»„ç»Ÿè®¡ (<code>loadSimilarityGroups()</code>)</li>
<li>æœ€è¿‘ç…§ç‰‡ (<code>loadRecentImages()</code>)</li>
<li>å…¶ä»–åˆ†ç±»æ•°æ®ï¼ˆé¢œè‰²ã€ç›®å½•ã€æ ¼å¼ç­‰ï¼‰</li>
</ul>
<p>---</p>
<h2>ç§»åŠ¨ç«¯æ‰«ææœåŠ¡æ¶æ„</h2>
<h3>1. æ‰«æçŠ¶æ€ç®¡ç†</h3>
<p>#### 1.1 çŠ¶æ€å˜é‡</p>
<ul>
<li><strong>ç•Œé¢å±‚çŠ¶æ€</strong> (<code>HomeScreen.mobile.js</code>):</li>
<li><code>isScanning</code>: React stateï¼Œæ§åˆ¶æ‰«æUIçŠ¶æ€</li>
<li><code>globalMessage</code>: React stateï¼Œæ˜¾ç¤ºæ‰«æè¿›åº¦æ¶ˆæ¯</li>
<li><code>window.isScanning</code>: å…¨å±€å˜é‡ï¼Œä¾›å…¶ä»–é¡µé¢æ£€æŸ¥æ‰«æçŠ¶æ€</li>
</ul>
<ul>
<li><strong>JSæœåŠ¡å±‚çŠ¶æ€</strong> (<code>GalleryScannerService.android.js</code>):</li>
<li><code>this.isScanning</code>: JSå±‚æ‰«æçŠ¶æ€æ ‡å¿—</li>
<li><code>this.currentScanId</code>: å½“å‰æ‰«æä»»åŠ¡ID</li>
<li><code>this.onProgress</code>: è¿›åº¦å›è°ƒå‡½æ•°å¼•ç”¨</li>
<li><code>this.eventEmitter</code>: åŸç”Ÿäº‹ä»¶ç›‘å¬å™¨</li>
</ul>
<ul>
<li><strong>åŸç”Ÿå±‚çŠ¶æ€</strong> (<code>GalleryScanService.java</code>):</li>
<li>æ‰«æä»»åŠ¡çŠ¶æ€ï¼ˆè¿è¡Œä¸­/å·²å®Œæˆ/å·²å–æ¶ˆï¼‰</li>
<li>æ‰«æè¿›åº¦ç»Ÿè®¡ï¼ˆå·²å¤„ç†/æ€»æ•°ï¼‰</li>
</ul>
<p>#### 1.2 çŠ¶æ€æµè½¬</p>
<pre><code></code></pre>
<h3>2. è¿›åº¦æ¶ˆæ¯æ›´æ–°æœºåˆ¶</h3>
<p>#### 2.1 è¿›åº¦æ¶ˆæ¯ç”Ÿæˆæµç¨‹ï¼ˆä¸‰å±‚æ¶æ„ï¼‰</p>
<pre><code></code></pre>
<p>#### 2.2 å‰å°æœåŠ¡é€šçŸ¥æ›´æ–°</p>
<ul>
<li><strong>æœåŠ¡å¯åŠ¨</strong>: <code>ScanService.startScanService()</code> å¯åŠ¨å‰å°æœåŠ¡</li>
<li><strong>è¿›åº¦æ›´æ–°</strong>: <code>ScanService.updateProgress(message, processed, total, title)</code></li>
<li><strong>æœåŠ¡åœæ­¢</strong>: <code>ScanService.stopScanService()</code> åœæ­¢å‰å°æœåŠ¡</li>
<li><strong>å¿ƒè·³æœºåˆ¶</strong>: æ¯10ç§’æ›´æ–°ä¸€æ¬¡é€šçŸ¥ï¼Œä¿æŒæœåŠ¡æ´»è·ƒ</li>
</ul>
<p>#### 2.3 è¿›åº¦æ¶ˆæ¯å»é‡</p>
<ul>
<li>ç§»åŠ¨ç«¯<strong>ä¸ç§»é™¤å»é‡é€»è¾‘</strong>ï¼Œå…è®¸æ‰€æœ‰è¿›åº¦æ›´æ–°é€šè¿‡</li>
<li>åŸå› ï¼šåŸç”Ÿå±‚å·²ç»æ§åˆ¶æ›´æ–°é¢‘ç‡ï¼ŒJSå±‚ä¸éœ€è¦å†æ¬¡è¿‡æ»¤</li>
</ul>
<h3>3. æ•°æ®è¯»å†™æœºåˆ¶</h3>
<p>#### 3.1 åŸç”Ÿå±‚æ•°æ®å†™å…¥</p>
<p>##### 3.1.1 åŸºç¡€æ‰«ææµç¨‹ï¼ˆç‹¬ç«‹æµç¨‹ï¼‰</p>
<pre><code></code></pre>
<p>##### 3.1.2 AIåˆ†ç±»æµç¨‹ï¼ˆç‹¬ç«‹æµç¨‹ï¼Œç”¨æˆ·æ‰‹åŠ¨è§¦å‘ï¼‰</p>
<pre><code></code></pre>
<p>#### 3.2 JSå±‚æ•°æ®è¯»å–</p>
<ul>
<li>ä¸PCç«¯ç›¸åŒï¼Œä½¿ç”¨ <code>UnifiedDataService</code> ç»Ÿä¸€æ¥å£</li>
<li>æ”¯æŒç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢</li>
</ul>
<p>#### 3.3 æ•°æ®åˆ·æ–°ç­–ç•¥</p>
<ul>
<li><strong>é˜²æŠ–æœºåˆ¶</strong>: ä½¿ç”¨ <code>loadAllDataDebounced()</code> é˜²æŠ–åˆ·æ–°ï¼ˆ500msï¼‰</li>
<li><strong>åˆ·æ–°è§¦å‘</strong>:</li>
<li>æ‰«æå®Œæˆæ—¶ï¼šæ¸…é™¤é˜²æŠ–å®šæ—¶å™¨ï¼Œå»¶è¿Ÿ600msååˆ·æ–°</li>
<li>ä½ç½®ä¿¡æ¯è¡¥å…¨ï¼šæ¯å¤„ç†50å¼ å›¾ç‰‡è§¦å‘é˜²æŠ–åˆ·æ–°</li>
<li>ç›¸ä¼¼åº¦æ£€æµ‹ï¼šæ¯æ£€æµ‹å®Œä¸€ä¸ªç›¸ä¼¼ç»„è§¦å‘é˜²æŠ–åˆ·æ–°</li>
</ul>
<h3>4. ç•Œé¢æ•°æ®åˆ·æ–°</h3>
<p>#### 4.1 åˆ·æ–°è§¦å‘ç‚¹</p>
<pre><code></code></pre>
<p>#### 4.2 é˜²æŠ–æœºåˆ¶</p>
<pre><code></code></pre>
<h3>6. ç§»åŠ¨å±‚æ¶æ„ï¼ˆä¸‰å±‚ï¼‰</h3>
<p>#### 6.1 å‰å°æœåŠ¡å±‚ (<code>ScanForegroundService.java</code>)</p>
<ul>
<li><strong>èŒè´£</strong>: ä¿æŒåº”ç”¨åœ¨åå°è¿è¡Œæ—¶ç»§ç»­æ‰«æ</li>
<li><strong>æœºåˆ¶</strong>:</li>
<li>å‰å°é€šçŸ¥æ˜¾ç¤ºæ‰«æè¿›åº¦</li>
<li>WakeLocké˜²æ­¢CPUä¼‘çœ </li>
<li>å¿ƒè·³æœºåˆ¶ï¼ˆ10ç§’ï¼‰ä¿æŒæœåŠ¡æ´»è·ƒ</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>:</li>
<li><code>START_SCAN</code>: å¯åŠ¨æœåŠ¡ï¼Œè·å–WakeLock</li>
<li><code>UPDATE_PROGRESS</code>: æ›´æ–°é€šçŸ¥å†…å®¹</li>
<li><code>STOP_SCAN</code>: åœæ­¢æœåŠ¡ï¼Œé‡Šæ”¾WakeLock</li>
</ul>
<p>#### 6.2 åŸç”Ÿå±‚ (<code>GalleryScanService.java</code>)</p>
<ul>
<li><strong>èŒè´£</strong>: æ‰§è¡Œå®é™…çš„æ‰«æå’Œåˆ†ç±»ä»»åŠ¡</li>
<li><strong>æœºåˆ¶</strong>:</li>
<li>ç‹¬ç«‹åå°çº¿ç¨‹æ‰§è¡Œæ‰«æ</li>
<li>MediaStore APIæ‰«æå›¾ç‰‡</li>
<li>SQLiteæ•°æ®åº“æ‰¹é‡å†™å…¥</li>
<li>MobileNetV3æ¨¡å‹æ¨ç†</li>
<li><strong>äº‹ä»¶é€šä¿¡</strong>:</li>
<li><code>GalleryScanProgress</code>: è¿›åº¦äº‹ä»¶</li>
<li><code>GalleryScanCompleted</code>: å®Œæˆäº‹ä»¶</li>
<li><code>GalleryScanError</code>: é”™è¯¯äº‹ä»¶</li>
</ul>
<p>#### 6.3 JSå±‚ (<code>GalleryScannerService.android.js</code>)</p>
<ul>
<li><strong>èŒè´£</strong>: åè°ƒåŸç”Ÿå±‚å’Œç•Œé¢å±‚</li>
<li><strong>æœºåˆ¶</strong>:</li>
<li>ç›‘å¬åŸç”Ÿå±‚äº‹ä»¶</li>
<li>å¤„ç†è¿›åº¦æ•°æ®å›½é™…åŒ–</li>
<li>æ›´æ–°å‰å°æœåŠ¡é€šçŸ¥</li>
<li>æ‰§è¡ŒJSå±‚åç»­å¤„ç†ï¼ˆä½ç½®è¡¥å…¨ã€ç›¸ä¼¼åº¦æ£€æµ‹ï¼‰</li>
<li><strong>æ¡¥æ¥æ¨¡å—</strong> (<code>ScanServiceModule.java</code>):</li>
<li><code>startScanService()</code>: å¯åŠ¨å‰å°æœåŠ¡</li>
<li><code>updateScanProgress()</code>: æ›´æ–°è¿›åº¦é€šçŸ¥</li>
<li><code>stopScanService()</code>: åœæ­¢å‰å°æœåŠ¡</li>
</ul>
<p>---</p>
<h2>å…³é”®æœºåˆ¶å¯¹æ¯”</h2>
<h3>1. æ‰«æçŠ¶æ€ç®¡ç†</h3>
<p>| ç‰¹æ€§ | PCç«¯ | ç§»åŠ¨ç«¯ |</p>
<p>|------|------|--------|</p>
<p>| çŠ¶æ€å˜é‡ | <code>isScanning</code>, <code>window.isScanning</code> | <code>isScanning</code>, <code>window.isScanning</code> |</p>
<p>| çŠ¶æ€è®¾ç½®æ—¶æœº | æ‰«æå¼€å§‹æ—¶ | æ‰«æå¼€å§‹æ—¶ |</p>
<p>| çŠ¶æ€æ¸…é™¤æ—¶æœº | æ‰«æå®Œæˆ/å¤±è´¥æ—¶ | æ‰«æå®Œæˆ/å¤±è´¥æ—¶ |</p>
<p>| å…¨å±€çŠ¶æ€ | <code>window.isScanning</code> | <code>window.isScanning</code> |</p>
<h3>2. è¿›åº¦æ¶ˆæ¯æ›´æ–°</h3>
<p>| ç‰¹æ€§ | PCç«¯ | ç§»åŠ¨ç«¯ |</p>
<p>|------|------|--------|</p>
<p>| æ¶ˆæ¯ç”Ÿæˆ | JSå±‚ <code>processProgressData()</code> | JSå±‚ <code>processProgressData()</code> |</p>
<p>| æ¶ˆæ¯å»é‡ | æœ‰ï¼ˆåŸºäºæ¶ˆæ¯é”®å€¼ï¼‰ | æ— ï¼ˆåŸç”Ÿå±‚å·²æ§åˆ¶é¢‘ç‡ï¼‰ |</p>
<p>| é€šçŸ¥æ›´æ–° | æ— ï¼ˆPCç«¯ä¸éœ€è¦ï¼‰ | æœ‰ï¼ˆå‰å°æœåŠ¡é€šçŸ¥ï¼‰ |</p>
<p>| æ›´æ–°é¢‘ç‡ | æ¯ä¸ªé˜¶æ®µæ›´æ–° | åŸç”Ÿå±‚æ§åˆ¶é¢‘ç‡ |</p>
<h3>3. æ•°æ®è¯»å†™</h3>
<p>| ç‰¹æ€§ | PCç«¯ | ç§»åŠ¨ç«¯ |</p>
<p>|------|------|--------|</p>
<p>| æ‰«æå®ç° | JSå±‚å®ç° | åŸç”Ÿå±‚å®ç° |</p>
<p>| æ•°æ®åº“æ“ä½œ | JSå±‚ç›´æ¥æ“ä½œ | åŸç”Ÿå±‚æ‰¹é‡æ“ä½œ |</p>
<p>| æ•°æ®åˆ·æ–° | ç›´æ¥åˆ·æ–° | é˜²æŠ–åˆ·æ–°ï¼ˆ500msï¼‰ |</p>
<p>| åˆ·æ–°è§¦å‘ | <code>shouldRefresh</code> æ ‡å¿— | <code>shouldRefresh</code> æ ‡å¿— |</p>
<h3>4. ç•Œé¢åˆ·æ–°</h3>
<p>| ç‰¹æ€§ | PCç«¯ | ç§»åŠ¨ç«¯ |</p>
<p>|------|------|--------|</p>
<p>| åˆ·æ–°æ–¹å¼ | ç›´æ¥è°ƒç”¨ <code>loadData()</code> | é˜²æŠ–è°ƒç”¨ <code>loadAllDataDebounced()</code> |</p>
<p>| åˆ·æ–°æ—¶æœº | æ‰«æå®Œæˆã€ä½ç½®è¡¥å…¨ | æ‰«æå®Œæˆã€ä½ç½®è¡¥å…¨ã€ç›¸ä¼¼åº¦æ£€æµ‹ |</p>
<p>| é˜²æŠ–æœºåˆ¶ | æ—  | æœ‰ï¼ˆ500mså»¶è¿Ÿï¼‰ |</p>
<h3>5. æ–°å¢åˆ†ç±»å¤„ç†</h3>
<p>| ç‰¹æ€§ | PCç«¯ | ç§»åŠ¨ç«¯ |</p>
<p>|------|------|--------|</p>
<p>| AIåˆ†ç±»å®ç° | JSå±‚MobileNetV3 | åŸç”Ÿå±‚MobileNetV3 |</p>
<p>| æ‰¹é‡å¤„ç† | JSå±‚æ‰¹æ¬¡å¤„ç† | åŸç”Ÿå±‚æ‰¹æ¬¡å¤„ç† |</p>
<p>| åç»­å¤„ç† | ä½ç½®è¡¥å…¨ã€ç›¸ä¼¼åº¦æ£€æµ‹ | ä½ç½®è¡¥å…¨ã€ç›¸ä¼¼åº¦æ£€æµ‹ |</p>
<p>| æ•°æ®æ›´æ–° | ç›´æ¥æ›´æ–°æ•°æ®åº“ | åŸç”Ÿå±‚æ‰¹é‡æ›´æ–°æ•°æ®åº“ |</p>
<h3>6. åå°æ‰§è¡Œèƒ½åŠ›</h3>
<p>| ç‰¹æ€§ | PCç«¯ | ç§»åŠ¨ç«¯ |</p>
<p>|------|------|--------|</p>
<p>| åå°æ‰«æ | æ”¯æŒï¼ˆElectronä¸»è¿›ç¨‹ï¼‰ | æ”¯æŒï¼ˆå‰å°æœåŠ¡ï¼‰ |</p>
<p>| è¿›ç¨‹ä¿æ´» | ä¸éœ€è¦ | WakeLock + å‰å°æœåŠ¡ |</p>
<p>| é€šçŸ¥æ˜¾ç¤º | ä¸éœ€è¦ | å‰å°æœåŠ¡é€šçŸ¥ |</p>
<p>| å¿ƒè·³æœºåˆ¶ | ä¸éœ€è¦ | 10ç§’å¿ƒè·³æ›´æ–°é€šçŸ¥ |</p>
<p>---</p>
<h2>æ€»ç»“</h2>
<h3>PCç«¯ç‰¹ç‚¹</h3>
<p>1. <strong>çº¯JSå®ç°</strong>: æ‰€æœ‰æ‰«æé€»è¾‘åœ¨JSå±‚å®ç°</p>
<p>2. <strong>ç®€å•ç›´æ¥</strong>: çŠ¶æ€ç®¡ç†å’Œè¿›åº¦æ›´æ–°ç®€å•ç›´æ¥</p>
<p>3. <strong>æ— åå°é™åˆ¶</strong>: Electronä¸»è¿›ç¨‹å¯ä»¥é•¿æ—¶é—´è¿è¡Œ</p>
<p>4. <strong>æ— é˜²æŠ–</strong>: æ•°æ®åˆ·æ–°ç›´æ¥æ‰§è¡Œï¼Œæ— éœ€é˜²æŠ–</p>
<h3>ç§»åŠ¨ç«¯ç‰¹ç‚¹</h3>
<p>1. <strong>ä¸‰å±‚æ¶æ„</strong>: å‰å°æœåŠ¡ + åŸç”Ÿå±‚ + JSå±‚</p>
<p>2. <strong>åå°ä¿æ´»</strong>: å‰å°æœåŠ¡ + WakeLockç¡®ä¿åå°æ‰§è¡Œ</p>
<p>3. <strong>é˜²æŠ–åˆ·æ–°</strong>: é¿å…é¢‘ç¹åˆ·æ–°å½±å“æ€§èƒ½</p>
<p>4. <strong>åŸç”Ÿæ€§èƒ½</strong>: åŸç”Ÿå±‚æ‰«æå’ŒAIåˆ†ç±»æ€§èƒ½æ›´å¥½</p>
<h3>å…±åŒç‚¹</h3>
<p>1. <strong>ç»Ÿä¸€æ¥å£</strong>: éƒ½ä½¿ç”¨ <code>GalleryScannerService</code> ç»Ÿä¸€æ¥å£</p>
<p>2. <strong>è¿›åº¦å›è°ƒ</strong>: éƒ½ä½¿ç”¨ <code>onProgress</code> å›è°ƒæ›´æ–°UI</p>
<p>3. <strong>æ•°æ®æœåŠ¡</strong>: éƒ½ä½¿ç”¨ <code>UnifiedDataService</code> ç»Ÿä¸€æ•°æ®æ¥å£</p>
<p>4. <strong>çŠ¶æ€ç®¡ç†</strong>: éƒ½ä½¿ç”¨ <code>isScanning</code> å’Œ <code>window.isScanning</code> ç®¡ç†çŠ¶æ€</p>
            </div>
            
            <div class="article-content">
                <div class="article-tags">
                    <span class="article-tag">æŠ€æœ¯æ¶æ„</span><span class="article-tag">æ‰«ææœåŠ¡</span><span class="article-tag">PCç«¯</span><span class="article-tag">ç§»åŠ¨ç«¯</span><span class="article-tag">ç³»ç»Ÿè®¾è®¡</span><span class="article-tag">ç ”å‘ç»éªŒ</span>
                </div>
            </div>
        </article>
        
        
        <div class="related-articles">
            <h2>ç›¸å…³æ–‡ç« </h2>
            <div class="related-articles-grid">
                
                <a href="backend-arch.html" class="related-article-card">
                    <h3>å›¾ç‰‡åˆ†ç±»åç«¯ç³»ç»Ÿ - èŠ¯å›¾ç›¸å†Œåç«¯æŠ€æœ¯æ–¹æ¡ˆ</h3>
                    <p>åŸºäºå¤§æ¨¡å‹æŠ€æœ¯çš„æ™ºèƒ½ç…§ç‰‡åˆ†ç±»æœåŠ¡åç«¯æŠ€æœ¯æ–¹æ¡ˆï¼ŒåŒ…å«æ¶æ„è®¾è®¡ã€æ ¸å¿ƒåŠŸèƒ½ã€æ€§èƒ½ä¼˜åŒ–ç­‰å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆã€‚</p>
                </a>
                <a href="async-arch.html" class="related-article-card">
                    <h3>èŠ¯å›¾ç›¸å†Œï¼šå¼‚æ­¥æ¶æ„ä¸é«˜å¹¶å‘æŠ€æœ¯è¯´æ˜</h3>
                    <p>æ·±å…¥è§£æå›¾ç‰‡åˆ†ç±»åç«¯ç³»ç»Ÿçš„å¼‚æ­¥æ¶æ„è®¾è®¡å’Œé«˜å¹¶å‘æŠ€æœ¯å®ç°ï¼ŒåŒ…å«å¼‚æ­¥è°ƒç”¨æ—¶åºå›¾ã€è¿æ¥æ± ã€å¤šè¿›ç¨‹æ¶æ„ç­‰æ ¸å¿ƒæŠ€æœ¯è¯¦è§£ã€‚</p>
                </a>
                <a href="deploy-arch.html" class="related-article-card">
                    <h3>èŠ¯å›¾ç›¸å†Œï¼šä¸‰å±‚éƒ¨ç½²æ¶æ„å›¾</h3>
                    <p>è¯¦ç»†è¯´æ˜èŠ¯å›¾ç›¸å†Œçš„ä¸‰å±‚éƒ¨ç½²æ¶æ„è®¾è®¡ï¼ŒåŒ…å«å®¢æˆ·ç«¯ã€WEBæœåŠ¡å±‚å’ŒAPPæœåŠ¡å™¨çš„å®Œæ•´æ¶æ„å›¾ï¼Œä»¥åŠäºŒç»´ç ç”Ÿæˆã€æ‰«ç å…³æ³¨ã€ä¼šå‘˜å¼€é€šç­‰å…³é”®ä¸šåŠ¡æµç¨‹æ—¶åºå›¾ã€‚</p>
                </a>
            </div>
        </div>
        
        
        <div class="article-footer">
            <a href="../diary.html" class="back-btn">â† è¿”å›æ—¥è®°åˆ—è¡¨</a>
        </div>
    </main>

    <!-- é¡µè„šå°†é€šè¿‡ components-loader.js è‡ªåŠ¨åŠ è½½ -->
    
    <script src="../script.js"></script>
</body>
</html>

