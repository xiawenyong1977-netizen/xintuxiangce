# 使用指南旧链接301重定向配置
# 文件位置：/etc/lighttpd/conf.d/xintuxiangce-redirects.conf
# 
# 作用：将旧的 /guide-*.html 链接重定向到新的 /guides/*.html
# 
# 配置说明：
# - 使用正则表达式匹配所有 guide-*.html 格式的URL
# - 重定向到 /guides/*.html 格式的新URL
# - 返回301永久重定向状态码，告诉搜索引擎链接已永久移动
#
# 使用方法：
# 1. 将此文件上传到服务器：scp xintuxiangce-redirects.conf root@web:/etc/lighttpd/conf.d/
# 2. 在主配置文件中添加：include "conf.d/xintuxiangce-redirects.conf"
# 3. 测试配置：lighttpd -t -f /etc/lighttpd/lighttpd.conf
# 4. 重启服务：systemctl restart lighttpd
# 5. 验证：curl -I https://www.xintuxiangce.top/guide-quick-start.html

# 使用指南旧链接301重定向
# 注意：此配置会被包含在主配置的 $SERVER["socket"] == ":443" 块内
# 因此不需要再次创建443块，直接使用$HTTP["host"]匹配即可
$HTTP["host"] =~ "^(www\.)?xintuxiangce\.top$" {
    # 使用指南旧链接301重定向
    # 使用正则表达式匹配所有 guide-*.html 格式的URL
    url.redirect = (
        "^/guide-quick-start\.html$" => "/guides/quick-start.html",
        "^/guide-permissions\.html$" => "/guides/permissions.html",
        "^/guide-cleanup\.html$" => "/guides/cleanup.html",
        "^/guide-multidimensional-classification\.html$" => "/guides/multidimensional-classification.html"
    )
}

